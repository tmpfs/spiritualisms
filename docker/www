# Runs the web server application
FROM node:argon

# Create www directory for web server
RUN mkdir -p /usr/src
WORKDIR /usr/src

# Install web application dependencies
COPY package.json /usr/src
RUN npm install --production

# Bundle web application source
COPY www-server.js /usr/src
RUN mkdir -p /usr/src/lib /usr/src/www
ADD lib /usr/src/lib
ADD www /usr/src/www

RUN npm i -g browserify stylus uglifyjs
RUN npm run minify
RUN npm run minify-css

EXPOSE 3000

CMD node www-server.js
