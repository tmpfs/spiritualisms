FROM node:argon

RUN apt-get update

RUN curl -O http://download.gna.org/wkhtmltopdf/0.12/0.12.4/wkhtmltox-0.12.4_linux-generic-amd64.tar.xz
RUN tar -xvf wkhtmltox-0.12.4_linux-generic-amd64.tar.xz
RUN mv wkhtmltox/bin/* /bin

# Create www directory for web server
RUN mkdir -p /usr/src
WORKDIR /usr/src

# Install web application dependencies
COPY package.json /usr/src
RUN npm install

# Bundle web application source
COPY file-server.js /usr/src
RUN mkdir -p /usr/src/lib /usr/src/file
ADD lib /usr/src/lib
ADD www /usr/src/www
ADD file /usr/src/file

EXPOSE 3001

CMD node file-server.js
